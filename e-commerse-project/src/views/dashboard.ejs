<%- include('partials/header') %>
<div class="container">
  <h1 class="mt-5 text-center">Products</h1>
  <% if (message && message.length > 0) { %>
  <div class="alert alert-success" role="alert"><%= message %></div>
  <% } %>
  <form action="/search" method="GET" class="mb-3">
    <div class="row">
      <div class="col-md-10">
        <input
          type="text"
          class="form-control"
          name="search"
          placeholder="Search by name or category"
          value="<%= typeof search !== 'undefined' ? search : '' %>"
        />
      </div>
      <div class="col-md-2">
        <button type="submit" class="btn btn-primary w-100">Search</button>
      </div>
    </div>
  </form>

  <div class="row">
    <% products.forEach(product => { %>
    <div class="col-md-4 col-sm-6 mb-4">
      <div class="card">
        <img
          src="<%= product.image %>"
          class="card-img-top"
          alt="<%= product.name %>"
        />
        <div class="card-body">
          <h5 class="card-title"><%= product.name %></h5>
          <p class="card-text">Price: $<%= product.price %></p>
          <p class="card-text">Category: <%= product.category %></p>
          <a href="/product/<%= product._id %>" class="btn btn-info"
            >View Details</a
          >

          <% if ( user ) { %>
          <a href="/app/edit/<%= product._id %>" class="btn btn-warning"
            >Add to cart</a
          >
          <!-- <a
            href="/app/delete/<%= product._id %>"
            class="btn btn-danger"
            onclick="return confirm('Are you sure?')"
            >Delete</a
          > -->
          <% } %>
        </div>
      </div>
    </div>
    <% }) %>
  </div>
</div>
<%- include('partials/footer') %>
